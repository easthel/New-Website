<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Client Management Dashboard</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="stylesheet" href="client.css" />
  </head>
  <body>
    <div class="container-fluid">
      <div class="row">
        <!-- Sidebar -->
        <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
          <div class="position-sticky">
            <div class="sidebar-header">
              <img src="/img/logo.png" alt="Logo" class="logo" />
            </div>
            <ul class="nav flex-column">
              <li class="nav-item">
                <a class="nav-link active" href="#" data-section="dashboard">
                  <i class="fas fa-tachometer-alt"></i> Dashboard
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#" data-section="profile">
                  <i class="fas fa-user"></i> My Profile
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#" data-section="appointments">
                  <i class="fas fa-calendar"></i> Appointments
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#" data-section="history">
                  <i class="fas fa-history"></i> History
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#" data-section="settings">
                  <i class="fas fa-cog"></i> Settings
                </a>
              </li>
            </ul>
          </div>
        </nav>

        <!-- Main content -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
          <!-- Dashboard Section -->
          <div class="section-content" id="dashboard-section">
            <div
              class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"
            >
              <h1 class="h2">Welcome, John Doe</h1>
              <div>
                <button
                  class="btn btn-avatar dropdown-toggle"
                  type="button"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                  title="User Menu"
                >
                  <i class="fas fa-user-circle"></i>
                </button>
                <ul class="dropdown-menu dropdown-menu-end">
                  <li>
                    <a class="dropdown-item text-danger" href="#" id="logoutBtn"
                      ><i class="fas fa-sign-out-alt"></i> Logout</a
                    >
                  </li>
                </ul>
              </div>
            </div>

            <!-- Quick Stats -->
            <div class="row mb-4">
              <div class="col-md-3">
                <div class="card stat-card">
                  <div class="card-body">
                    <h6 class="card-subtitle mb-2 text-muted">
                      Upcoming Appointments
                    </h6>
                    <h2 class="card-title" data-stat="appointments">2</h2>
                    <p class="card-text">
                      <small class="text-muted">Next: March 25, 2024</small>
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Current Grooming Status -->
            <div class="row mb-4">
              <div class="col-12">
                <div class="card">
                  <div class="card-header">
                    <h5 class="card-title mb-0">Current Grooming Status</h5>
                  </div>
                  <div class="card-body">
                    <div class="grooming-status">
                      <div class="d-flex align-items-center mb-3">
                        <div class="status-indicator bg-warning me-3"></div>
                        <div class="flex-grow-1">
                          <h6 class="mb-1">Max - Basic Grooming</h6>
                          <p class="mb-0 text-muted">In Progress - Bathing</p>
                          <small class="text-muted">Started: 10:00 AM</small>
                        </div>
                        <div class="estimated-time">
                          <small class="text-muted"
                            >Estimated completion: 11:00 AM</small
                          >
                        </div>
                      </div>
                      <div class="progress mb-2">
                        <div
                          class="progress-bar bg-warning"
                          role="progressbar"
                          aria-valuenow="50"
                          aria-valuemin="0"
                          aria-valuemax="100"
                          title="50% progress"
                        ></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Recent Activity -->
            <div class="row">
              <div class="col-md-12">
                <div class="card">
                  <div class="card-header">
                    <h5 class="card-title mb-0">Recent Appointments</h5>
                  </div>
                  <div class="card-body">
                    <div class="list-group recent-appointments">
                      <!-- Content will be populated by JavaScript -->
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Profile Section -->
          <div class="section-content" id="profile-section">
            <div
              class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"
            >
              <h1 class="h2">My Profile</h1>
            </div>
            <div class="row justify-content-center">
              <div class="col-md-8">
                <div class="card">
                  <div class="card-header text-center">
                    <h5 class="card-title mb-0">Personal Information</h5>
                  </div>
                  <div class="card-body">
                    <div class="profile-info text-center">
                      <p>
                        <strong>Name:</strong>
                        <span id="profile-name">John Doe</span>
                      </p>
                      <p>
                        <strong>Email:</strong>
                        <span id="profile-email">john.doe@email.com</span>
                      </p>
                      <p>
                        <strong>Phone:</strong>
                        <span id="profile-phone">(555) 123-4567</span>
                      </p>
                      <p>
                        <strong>Address:</strong>
                        <span id="profile-address">123 Main St, City</span>
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row justify-content-center mt-4">
              <div class="col-md-8">
                <div class="card">
                  <div
                    class="card-header d-flex justify-content-between align-items-center"
                  >
                    <h5 class="card-title mb-0">My Pets</h5>
                    <button
                      type="button"
                      class="btn btn-sm btn-primary"
                      data-bs-toggle="modal"
                      data-bs-target="#addPetModal"
                    >
                      <i class="fas fa-plus"></i> Add Pet
                    </button>
                  </div>
                  <div class="card-body">
                    <div class="pets-list">
                      <div id="pet-section" class="card mb-3"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <script>
              console.log("hello world");

              const profileNav = document.querySelector(
                '[data-section="profile"]'
              );
              const petSection = document.querySelector("#pet-section");

              profileNav.onclick = async function () {
                const supabasePublicClient = await supabase.createClient(
                  "https://zehjuqavoktgxjqwcqpo.supabase.co",
                  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InplaGp1cWF2b2t0Z3hqcXdjcXBvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYyMDA2ODAsImV4cCI6MjA2MTc3NjY4MH0.n2Nb0QgaZFVW4zC0NyQGAy38tka_gwkhiTrBC8rU-GM",
                  { db: { schema: "public" } }
                );

                const { count, error: countErr } = await supabasePublicClient
                  .from("profile-pets")
                  .select("*", { count: "exact" });

                console.log(count);

                const { data: pets, error } = await supabasePublicClient
                  .from("profile-pets")
                  .select("*");

                for (let i = 0; i < pets.length; i++) {
                  const section = document.createElement("div");

                  section.innerHTML = `
                    <div class="card-body p-3">
                      <div id="pet-section" class="row align-items-center">
                        <div class="col-md-2 text-center">
                          <img
                            src="https://via.placeholder.com/80"
                            class="rounded-circle"
                            alt="Pet Image"
                          />
                        </div>
                        <div class="col-md-7">
                          <h5 class="mb-1">${pets[i].petName}</h5>
                          <p class="mb-1 text-muted">
                            ${pets[i].petBreed} • 3 years • Male
                          </p>
                          <small class="text-muted"
                            >Last Visit: March 15, 2024</small
                          >
                        </div>
                        <div class="col-md-3 text-end">
                          <button
                            type="button"
                            class="btn btn-sm btn-outline-primary me-2 edit-pet-btn"
                            data-bs-toggle="modal"
                            data-bs-target="#editPetModal"
                            title="Edit Pet"
                            data-pet-id="${pets[i].id}"
                            data-pet-name="${pets[i].petName}"
                            data-pet-species="${pets[i].petSpecies}"
                            data-pet-breed="${pets[i].petBreed}"
                          >
                            <i class="fas fa-edit"></i>
                          </button>
                          <button
                            type="button"
                            class="btn btn-sm btn-outline-danger delete-pet-btn"
                            title="Delete Pet"
                            data-pet-id="${pets[i].id}"
                          >
                            <i class="fas fa-trash"></i>
                          </button>
                        </div>
                      </div>
                    </div>
                  `;

                  petSection.appendChild(section);
                }

                // Add event listeners to delete buttons after they are created
                const deleteButtons =
                  document.querySelectorAll(".delete-pet-btn");
                deleteButtons.forEach((button) => {
                  button.addEventListener("click", async function () {
                    const petId = this.getAttribute("data-pet-id");
                    const petName =
                      this.closest(".card-body").querySelector(
                        "h5"
                      ).textContent;

                    if (
                      confirm(`Are you sure you want to delete ${petName}?`)
                    ) {
                      try {
                        const { error } = await supabasePublicClient
                          .from("profile-pets")
                          .delete()
                          .eq("id", petId);

                        if (error) {
                          alert("Error deleting pet: " + error.message);
                        } else {
                          // Remove the pet card from the DOM
                          this.closest(".card-body").parentElement.remove();
                          alert(`${petName} was deleted successfully!`);
                        }
                      } catch (err) {
                        console.error("Error deleting pet:", err);
                        alert("An error occurred while deleting the pet.");
                      }
                    }
                  });
                });

                // Add event listeners to edit buttons
                const editButtons = document.querySelectorAll(".edit-pet-btn");
                editButtons.forEach((button) => {
                  button.addEventListener("click", function () {
                    // Get pet data from button attributes
                    const petId = this.getAttribute("data-pet-id");
                    const petName = this.getAttribute("data-pet-name");
                    const petSpecies = this.getAttribute("data-pet-species");
                    const petBreed = this.getAttribute("data-pet-breed");

                    // Set values in edit form
                    document.querySelector(
                      '#editPetForm input[name="petName"]'
                    ).value = petName;

                    // Find and select the correct option in the species dropdown
                    const speciesSelect = document.querySelector(
                      '#editPetForm select[name="petSpecies"]'
                    );
                    for (let i = 0; i < speciesSelect.options.length; i++) {
                      if (speciesSelect.options[i].value === petSpecies) {
                        speciesSelect.selectedIndex = i;
                        break;
                      }
                    }

                    document.querySelector(
                      '#editPetForm input[name="petBreed"]'
                    ).value = petBreed;

                    // Store the pet ID in a data attribute on the form for later use
                    document
                      .getElementById("editPetForm")
                      .setAttribute("data-pet-id", petId);
                  });
                });
              };
            </script>
          </div>

          <!-- Appointments Section -->
          <div class="section-content hidden" id="appointments-section">
            <div
              class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"
            >
              <h1 class="h2">My Appointments</h1>
              <button
                type="button"
                class="btn btn-primary"
                data-bs-toggle="modal"
                data-bs-target="#scheduleAppointmentModal"
              >
                <i class="fas fa-plus"></i> Schedule New Appointment
              </button>
            </div>
            <div class="row">
              <div class="col-md-6">
                <div class="card">
                  <div class="card-header">
                    <h5 class="card-title mb-0">Upcoming Appointments</h5>
                  </div>
                  <div class="card-body">
                    <div class="list-group upcoming-appointments-list">
                      <!-- Content will be populated by JavaScript -->
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="card">
                  <div class="card-header">
                    <h5 class="card-title mb-0">Available Services</h5>
                  </div>
                  <div class="card-body">
                    <div class="list-group">
                      <div class="list-group-item">
                        <h6 class="mb-1">Full & Basic Grooming</h6>
                        <p class="mb-1">
                          Includes bath, brush, nail trim, and ear cleaning.
                          <br />₱1,500
                        </p>
                      </div>
                      <div class="list-group-item">
                        <h6 class="mb-1">Bath & Blowdry</h6>
                        <p class="mb-1">
                          Complete bath with blowdry and coat conditioning.
                          <br />₱800
                        </p>
                      </div>
                      <div class="list-group-item">
                        <h6 class="mb-1">Haircut</h6>
                        <p class="mb-1">
                          Professional haircut and styling for your pet.
                          <br />₱1,200
                        </p>
                      </div>
                      <div class="list-group-item">
                        <h6 class="mb-1">Nail Trim</h6>
                        <p class="mb-1">
                          Safe and precise nail trimming service. <br />₱300
                        </p>
                      </div>
                      <div class="list-group-item">
                        <h6 class="mb-1">Ear Cleaning</h6>
                        <p class="mb-1">
                          Gentle ear cleaning to prevent infections. <br />₱400
                        </p>
                      </div>
                      <div class="list-group-item">
                        <h6 class="mb-1">Teeth Brushing</h6>
                        <p class="mb-1">
                          Thorough teeth cleaning for better oral health.
                          <br />₱500
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- History Section -->
          <div class="section-content hidden" id="history-section">
            <div
              class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"
            >
              <h1 class="h2">Appointment History</h1>
            </div>
            <div class="card">
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-hover">
                    <thead>
                      <tr>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Service</th>
                        <th>Pet</th>
                        <th>Status</th>
                      </tr>
                    </thead>
                    <tbody id="history-table-body">
                      <!-- Content will be populated by JavaScript -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <!-- Settings Section -->
          <div class="section-content" id="settings-section">
            <div
              class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"
            >
              <h1 class="h2">Account Settings</h1>
            </div>
            <div class="row">
              <div class="col-md-6 mb-4">
                <div class="card">
                  <div class="card-header">
                    <h5 class="card-title mb-0">Profile Settings</h5>
                  </div>
                  <div class="card-body">
                    <button
                      type="button"
                      class="btn btn-primary w-100"
                      data-bs-toggle="modal"
                      data-bs-target="#editProfileModal"
                    >
                      <i class="fas fa-edit"></i> Edit Profile
                    </button>
                  </div>
                </div>
              </div>
              <div class="col-md-6 mb-4">
                <div class="card">
                  <div class="card-header">
                    <h5 class="card-title mb-0">Security Settings</h5>
                  </div>
                  <div class="card-body">
                    <form id="securityForm">
                      <div class="mb-3">
                        <label class="form-label">Change Password</label>
                        <input
                          type="password"
                          class="form-control"
                          placeholder="Current Password"
                        />
                      </div>
                      <div class="mb-3">
                        <input
                          type="password"
                          class="form-control"
                          placeholder="New Password"
                        />
                      </div>
                      <div class="mb-3">
                        <input
                          type="password"
                          class="form-control"
                          placeholder="Confirm New Password"
                        />
                      </div>
                      <button type="submit" class="btn btn-primary w-100">
                        Update Password
                      </button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <!-- Edit Profile Modal -->
    <div class="modal fade" id="editProfileModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit Profile</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              title="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="profileForm">
              <div class="mb-3">
                <label class="form-label">Full Name</label>
                <input
                  type="text"
                  class="form-control"
                  name="fullName"
                  value="John Doe"
                  required
                  placeholder="Enter your full name"
                  title="Full Name"
                />
              </div>
              <div class="mb-3">
                <label class="form-label">Email</label>
                <input
                  type="email"
                  class="form-control"
                  name="email"
                  value="john.doe@email.com"
                  required
                  placeholder="Enter your email"
                  title="Email"
                />
              </div>
              <div class="mb-3">
                <label class="form-label">Phone Number</label>
                <input
                  type="tel"
                  class="form-control"
                  name="phone"
                  value="(555) 123-4567"
                  required
                  placeholder="Enter your phone number"
                  title="Phone Number"
                />
              </div>
              <div class="mb-3">
                <label class="form-label">Address</label>
                <textarea
                  class="form-control"
                  name="address"
                  rows="2"
                  placeholder="Enter your address"
                  title="Address"
                >
123 Main St, City</textarea
                >
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button type="button" class="btn btn-primary" id="saveProfile">
              Save Changes
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Schedule Appointment Modal -->
    <div class="modal fade" id="scheduleAppointmentModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Schedule New Appointment</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              title="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="appointmentForm">
              <div class="mb-3">
                <label class="form-label">Pet Name</label>
                <input
                  type="text"
                  class="form-control"
                  name="petName"
                  required
                  title="Pet Name"
                  placeholder=""
                />
              </div>
              <div class="mb-3">
                <label class="form-label">Pet Type</label>
                <select
                  class="form-select"
                  name="petType"
                  required
                  title="Pet Type"
                >
                  <option value=""></option>
                  <option value="dog">Dog</option>
                  <option value="cat">Cat</option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Service Type</label>
                <select
                  class="form-select"
                  name="serviceType"
                  required
                  title="Service Type"
                >
                  <option value=""></option>
                  <option value="full&basic-grooming">
                    Full & Basic Grooming
                  </option>
                  <option value="bath&blowdry">Bath & Blowdry</option>
                  <option value="haircut">Haircut</option>
                  <option value="nail-trim">Nail Trim</option>
                  <option value="ear-cleaning">Ear Cleaning</option>
                  <option value="teeth-brushing">Teeth Brushing</option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Staff</label>
                <select class="form-select" name="staff" required title="Staff">
                  <option value=""></option>
                  <option value="staff1">Staff 1</option>
                  <option value="staff2">Staff 2</option>
                  <option value="staff3">Staff 3</option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Preferred Date</label>
                <input type="date" class="form-control" name="appointmentDate"
                required title="Preferred Date" placeholder=">
              </div>

              <div class="mb-3">
                <label class="form-label">Preferred Time</label>
                <input
                  type="time"
                  class="form-control"
                  name="appointmentTime"
                  required
                  title="Preferred Time"
                  placeholder=""
                />
              </div>
              <div class="mb-3">
                <label class="form-label">Special Requests</label>
                <textarea
                  class="form-control"
                  name="specialRequests"
                  rows="2"
                  title="Special Requests"
                  placeholder="Enter any special requests"
                ></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="scheduleAppointment"
            >
              Schedule
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Pet Modal -->
    <div class="modal fade" id="addPetModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add New Pet</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              title="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="petForm">
              <div class="mb-3">
                <label class="form-label">Pet Name</label>
                <input
                  id="pet-name"
                  type="text"
                  class="form-control"
                  name="petName"
                  required
                  title="Pet Name"
                  placeholder="Enter your pet's name"
                />
              </div>
              <div class="mb-3">
                <label class="form-label">Species</label>
                <select
                  id="pet-species"
                  class="form-select"
                  name="petSpecies"
                  required
                  title="Pet Species"
                >
                  <option value="">Select species</option>
                  <option value="dog">Dog</option>
                  <option value="cat">Cat</option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Breed</label>
                <input
                  id="pet-breed"
                  type="text"
                  class="form-control"
                  name="petBreed"
                  required
                  title="Pet Breed"
                  placeholder="Enter your pet's breed"
                />
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button type="button" class="btn btn-primary" id="savePet">
              Add Pet
              <script>
                const btnAddPet = document.querySelector("#savePet");
                const petName = document.querySelector("#pet-name");
                const petSpecies = document.querySelector("#pet-species");
                const petBreed = document.querySelector("#pet-breed");

                btnAddPet.onclick = async function () {
                  const supabasePublicClient = supabase.createClient(
                    "https://zehjuqavoktgxjqwcqpo.supabase.co",
                    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InplaGp1cWF2b2t0Z3hqcXdjcXBvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYyMDA2ODAsImV4cCI6MjA2MTc3NjY4MH0.n2Nb0QgaZFVW4zC0NyQGAy38tka_gwkhiTrBC8rU-GM",
                    { db: { schema: "public" } }
                  );
                  console.log(petName.value);
                  console.log(petSpecies.value);
                  console.log(petBreed.value);

                  // async function loadData() {
                  const { data, error } = await supabasePublicClient
                    .from("profile-pets")
                    .insert({
                      petName: petName.value,
                      petSpecies: petSpecies.value,
                      petBreed: petBreed.value,
                    })
                    .select("*");

                  // const container = document.querySelector(".container");

                  // if (error) {
                  //   container.textContent = "Error: " + error.message;
                  // } else {
                  //   container.textContent = JSON.stringify(data, null, 2);
                  // }
                  console.log(data);
                  window.location.reload();
                };

                // loadData();
                // };
              </script>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Pet Modal -->
    <div class="modal fade" id="editPetModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit Pet Information</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              title="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="editPetForm">
              <div class="mb-3">
                <label class="form-label">Pet Name</label>
                <input
                  id="edit-pet-name"
                  type="text"
                  class="form-control"
                  name="petName"
                  required
                  title="Pet Name"
                  placeholder="Enter your pet's name"
                />
              </div>
              <div class="mb-3">
                <label class="form-label">Species</label>
                <select
                  id="edit-pet-species"
                  class="form-select"
                  name="petSpecies"
                  required
                  title="Pet Species"
                >
                  <option value="dog">Dog</option>
                  <option value="cat">Cat</option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Breed</label>
                <input
                  id="edit-pet-breed"
                  type="text"
                  class="form-control"
                  name="petBreed"
                  required
                  title="Pet Breed"
                  placeholder="Enter your pet's breed"
                />
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button type="button" class="btn btn-primary" id="updatePet">
              Save Changes
              <script>
                const btnUpdatePet = document.querySelector("#updatePet");

                btnUpdatePet.onclick = async function () {
                  const editPetForm = document.getElementById("editPetForm");
                  const petId = editPetForm.getAttribute("data-pet-id");
                  const editPetName = document.querySelector("#edit-pet-name");
                  const editPetSpecies =
                    document.querySelector("#edit-pet-species");
                  const editPetBreed =
                    document.querySelector("#edit-pet-breed");

                  const supabasePublicClient = supabase.createClient(
                    "https://zehjuqavoktgxjqwcqpo.supabase.co",
                    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InplaGp1cWF2b2t0Z3hqcXdjcXBvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYyMDA2ODAsImV4cCI6MjA2MTc3NjY4MH0.n2Nb0QgaZFVW4zC0NyQGAy38tka_gwkhiTrBC8rU-GM",
                    { db: { schema: "public" } }
                  );

                  try {
                    const { data, error } = await supabasePublicClient
                      .from("profile-pets")
                      .update({
                        petName: editPetName.value,
                        petSpecies: editPetSpecies.value,
                        petBreed: editPetBreed.value,
                      })
                      .eq("id", petId)
                      .select("*");

                    if (error) {
                      alert("Error updating pet: " + error.message);
                    } else {
                      // Close modal
                      const modal = bootstrap.Modal.getInstance(
                        document.getElementById("editPetModal")
                      );
                      modal.hide();

                      // Reload page to show updated pet information
                      window.location.reload();

                      alert("Pet information updated successfully!");
                    }
                  } catch (err) {
                    console.error("Error updating pet:", err);
                    alert(
                      "An error occurred while updating the pet information."
                    );
                  }
                };
              </script>
            </button>
          </div>
        </div>
      </div>
    </div>

    <style>
      .status-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
      }
      .progress {
        background-color: #e9ecef;
      }
      .btn-avatar {
        background-color: #6c757d;
        border-color: #6c757d;
      }
      .btn-avatar:hover {
        background-color: #5a6268;
        border-color: #545b62;
      }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.49.4/dist/umd/supabase.min.js"></script>
    <script src="client.js"></script>
    <script>
      // Handle sidebar navigation
      document.addEventListener("DOMContentLoaded", function () {
        // Get all navigation links
        const navLinks = document.querySelectorAll(".nav-link");

        // Add click event listener to each link
        navLinks.forEach((link) => {
          link.addEventListener("click", function (e) {
            e.preventDefault();

            // Remove active class from all links
            navLinks.forEach((l) => l.classList.remove("active"));

            // Add active class to clicked link
            this.classList.add("active");

            // Get the target section
            const targetSection = this.getAttribute("data-section");

            // Hide all sections
            document.querySelectorAll(".section-content").forEach((section) => {
              section.style.display = "none";
            });

            // Show the target section
            document.getElementById(`${targetSection}-section`).style.display =
              "block";
          });
        });

        // Handle logout button click
        const logoutBtn = document.getElementById("logoutBtn");
        logoutBtn.addEventListener("click", function (e) {
          e.preventDefault();
          if (confirm("Are you sure you want to logout?")) {
            // Redirect to login page
            window.location.href = "login.html";
          }
        });

        // Handle appointment scheduling
        const scheduleButton = document.getElementById("scheduleAppointment");
        const appointmentForm = document.getElementById("appointmentForm");

        scheduleButton.addEventListener("click", function () {
          const formData = new FormData(appointmentForm);
          const serviceType = formData.get("serviceType");
          const appointmentDate = formData.get("appointmentDate");
          const appointmentTime = formData.get("appointmentTime");
          const specialRequests = formData.get("specialRequests");

          if (!serviceType || !appointmentDate || !appointmentTime) {
            alert("Please fill in all required fields");
            return;
          }

          // Create new appointment card
          const appointmentCard = document.createElement("div");
          appointmentCard.className = "list-group-item";
          appointmentCard.innerHTML = `
                    <div class="d-flex w-100 justify-content-between">
                        <h6 class="mb-1">${serviceType}</h6>
                        <small>${appointmentDate} at ${appointmentTime}</small>
                    </div>
                    <p class="mb-1">${
                      specialRequests || "No special requests"
                    }</p>
                    <small class="text-muted">Status: Pending</small>
                `;

          // Add to upcoming appointments list
          const upcomingAppointments = document.querySelector(
            ".upcoming-appointments-list"
          );
          upcomingAppointments.appendChild(appointmentCard);

          // Update appointment count
          const appointmentCount = document.querySelector(
            '[data-stat="appointments"]'
          );
          const currentCount = parseInt(appointmentCount.textContent);
          appointmentCount.textContent = currentCount + 1;

          // Close modal and reset form
          const modal = bootstrap.Modal.getInstance(
            document.getElementById("scheduleAppointmentModal")
          );
          modal.hide();
          appointmentForm.reset();

          // Show success message
          alert("Appointment scheduled successfully!");
        });
      });
    </script>
  </body>
</html>
